<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Flowgrid MVP</title>
    <script>
      (function ensureTrailingSlash() {
        const { pathname, search, hash } = window.location;
        if (
          pathname !== '/' &&
          !pathname.endsWith('/') &&
          !pathname.split('/').pop()?.includes('.')
        ) {
          const normalizedPath = `${pathname}/`;
          window.location.replace(`${normalizedPath}${search}${hash}`);
        }
      })();
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module">
      const isLocalHost = ['localhost', '127.0.0.1', '::1'].includes(
        window.location.hostname,
      );
      const pathSegments = window.location.pathname.split('/').filter(Boolean);
      const isDocsDirectory = pathSegments.includes('docs');

      if (isLocalHost) {
        import('/src/main.ts');
      } else {
        const assetBase = isDocsDirectory ? './' : './docs/';
        const stylesheet = document.createElement('link');
        stylesheet.rel = 'stylesheet';
        stylesheet.href = `${assetBase}main.css`;
        document.head.appendChild(stylesheet);
        import(`${assetBase}chunks/main.js`);
      }
    </script>
  </body>
</html>
